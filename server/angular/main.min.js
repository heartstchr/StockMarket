!function(){"use strict";function t(t){t.when("/",{controller:"HomeController",templateUrl:"views/task/task1.html",controllerAs:"rksv"}).when("/404",{title:"404 ",controller:"404Controller",templateUrl:"views/404.html",controllerAs:"rksv"}).otherwise({redirectTo:"/404"})}angular.module("app",["ngRoute","ui.bootstrap"]).config(t),t.$inject=["$routeProvider"]}(),function(){"use strict";function t(t){function e(){return t.get(i+"/api").then(n,a("Error getting all status"))}function r(){return t.get(i+"/api/historical/?interval=1").then(n,a("Error getting historical"))}function n(t){return t.data}function a(t){return function(){return{success:!1,message:t}}}var o={},i="http://kaboom.rksv.net";return o.GetAll=r,o.GetStatus=e,o}angular.module("app").factory("rksvService",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){var e="http://kaboom.rksv.net/",r=io(e+"watch");return{on:function(e,n){r.on(e,function(){var e=arguments;t.$apply(function(){n.apply(r,e)})})},emit:function(e,n,a){r.emit(e,n,function(){var e=1;t.$apply(function(){a&&a.apply(r,e)})})}}}angular.module("app").factory("socketService",t),t.$inject=["$rootScope"]}(),function(){"use strict";function t(t,e){e?d3.select(".liveGraph").selectAll("svg").remove():d3.select(".graph").selectAll("svg").remove();var r={top:20,right:50,bottom:30,left:50},n=700-r.left-r.right,a=300-r.top-r.bottom,t=t.map(function(t){var e=t.split(","),r={timestamp:new Date(e[0]/1e3),open:+e[1],high:+e[2],low:+e[3],close:+e[4],volume:+e[5]};return r}),o=d3.time.scale().range([0,n]),i=d3.scale.linear().range([a,0]),l=d3.scale.linear().range([a,0]),s=d3.svg.axis().scale(o).orient("bottom").ticks(7),c=(d3.svg.axis().scale(i).orient("left").ticks(4),d3.svg.axis().scale(l).orient("right").ticks(3)),u=d3.svg.area().x(function(t){return o(t.timestamp)}).y0(a).y1(function(t){return i(t.close)}),p=d3.svg.line().x(function(t){return o(t.timestamp)}).y(function(t){return l(t.open)}),f=function(){return d3.svg.axis().scale(i).orient("left").ticks(4)};if(e)var d=d3.select(".liveGraph").append("svg").attr("width",n+r.left+r.right).attr("height",a+r.top+r.bottom);else var d=d3.select(".graph").append("svg").attr("width",n+r.left+r.right).attr("height",a+r.top+r.bottom);d.append("g").attr("transform","translate("+r.left+","+r.top+")");o.domain(d3.extent(t,function(t){return t.timestamp})),i.domain(d3.extent(t,function(t){return t.close})),l.domain([0,d3.max(t,function(t){return Math.max(t.open)})]),d.append("g").attr("class","x axis").attr("transform","translate("+r.left+","+(a+r.top)+")").call(s),d.append("g").attr("class","y axis chart__grid").attr("transform","translate("+r.left+","+r.top+")").style("fill","#878787").call(f().tickSize(-n,0,0)).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").style("fill","#878787").text("Close Price $"),d.append("g").attr("class","y axis").attr("transform","translate("+(n+r.left)+" ,"+r.top+")").style("fill","#f97f7f").call(c).append("text").attr("transform","rotate(-90)").attr("y",-18).attr("dy",".71em").style("text-anchor","end").text("Open Price $"),d.append("path").datum(t).attr("class","line").attr("transform","translate("+r.left+","+r.top+")").attr("d",u),d.append("path").style("stroke","red").style("fill","none").attr("transform","translate("+r.left+","+r.top+")").attr("d",p(t))}function e(e,r,n,a){e.tabs=[{title:"1D"},{title:"1M"},{title:"3M"},{title:"YTD"},{title:"1Y"},{title:"ALL"}],e.datasub=[],e.data=[],e.rate=2,e.getReport=function(e){n.GetStatus().then(function(e){"OK"==e.status&&n.GetAll().then(function(e){t(e)})})},a.on("error",function(t){console.error("Connection Error:",t)});var o=1,i=!0;a.on("data",function(n,a){r(function(){a(o)},1e3*e.rate),e.datasub.push({data:n}),e.data.push(n),t(e.data,i)}),e.sub=function(){a.emit("sub",{state:!0})},e.unsub=function(){a.emit("unsub",{state:!1})}}angular.module("app").controller("HomeController",e),e.$injector=["$scope","$timeout","rksvService","socketService"]}();